{% extends 'core/base.html' %}

{% block title %}
{% if object %}Edit Outcome{% else %}Add Outcome{% endif %} - Uganda Tech Connect
{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <!-- Header -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h2 class="fw-bold mb-1">
                        <i class="fa-solid fa-trophy text-warning me-2"></i>
                        {% if object %}Edit Outcome{% else %}Record New Outcome{% endif %}
                    </h2>
                    <p class="text-muted mb-0">
                        {% if object %}Update outcome information and commercialization status{% else %}Document project achievements and deliverables{% endif %}
                    </p>
                </div>
                <a href="{% url 'core:outcome_list' %}" class="btn btn-outline-secondary">
                    <i class="fa-solid fa-arrow-left me-2"></i>Back to Outcomes
                </a>
            </div>

            <!-- Form Card -->
            <div class="card shadow-sm border-0">
                <div class="card-header bg-warning bg-opacity-10 border-0">
                    <h5 class="card-title mb-0">
                        <i class="fa-solid fa-edit me-2"></i>Outcome Information
                    </h5>
                </div>
                <div class="card-body p-4">
                    <form method="post" novalidate>
                        {% csrf_token %}
                        
                        <!-- Error Messages -->
                        {% if form.non_field_errors %}
                            <div class="alert alert-danger mb-4" role="alert">
                                <i class="fa-solid fa-exclamation-triangle me-2"></i>
                                {{ form.non_field_errors }}
                            </div>
                        {% endif %}

                        <!-- Project Information Section -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h6 class="fw-bold text-primary border-bottom pb-2 mb-3">
                                    <i class="fa-solid fa-lightbulb me-2"></i>Project Information
                                </h6>
                            </div>

                            <!-- Project -->
                            <div class="col-md-12 mb-3">
                                <label for="{{ form.project.id_for_label }}" class="form-label fw-semibold">
                                    <i class="fa-solid fa-project-diagram text-primary me-1"></i>
                                    Associated Project <span class="text-danger">*</span>
                                </label>
                                <select class="form-select {% if form.project.errors %}is-invalid{% endif %}" 
                                        id="{{ form.project.id_for_label }}" 
                                        name="{{ form.project.name }}">
                                    <option value="">Select Project</option>
                                    {% for choice in form.project.field.queryset %}
                                        <option value="{{ choice.pk }}" 
                                                {% if choice.pk == form.project.value %}selected{% endif %}>
                                            {{ choice.Title }} - {{ choice.get_Category_display }}
                                        </option>
                                    {% endfor %}
                                </select>
                                {% if form.project.errors %}
                                    <div class="invalid-feedback">
                                        {{ form.project.errors|first }}
                                    </div>
                                {% endif %}
                                {% if form.project.help_text %}
                                    <div class="form-text">{{ form.project.help_text }}</div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- Outcome Details Section -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h6 class="fw-bold text-success border-bottom pb-2 mb-3">
                                    <i class="fa-solid fa-clipboard-check me-2"></i>Outcome Details
                                </h6>
                            </div>

                            <!-- Outcome Type -->
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.outcome_type.id_for_label }}" class="form-label fw-semibold">
                                    <i class="fa-solid fa-tags text-success me-1"></i>
                                    Outcome Type <span class="text-danger">*</span>
                                </label>
                                <select class="form-select {% if form.outcome_type.errors %}is-invalid{% endif %}" 
                                        id="{{ form.outcome_type.id_for_label }}" 
                                        name="{{ form.outcome_type.name }}">
                                    <option value="">Select Outcome Type</option>
                                    {% for value, label in form.outcome_type.field.choices %}
                                        {% if value %}
                                            <option value="{{ value }}" 
                                                    {% if value == form.outcome_type.value %}selected{% endif %}>
                                                {{ label }}
                                            </option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                                {% if form.outcome_type.errors %}
                                    <div class="invalid-feedback">
                                        {{ form.outcome_type.errors|first }}
                                    </div>
                                {% endif %}
                                {% if form.outcome_type.help_text %}
                                    <div class="form-text">{{ form.outcome_type.help_text }}</div>
                                {% endif %}
                            </div>

                            <!-- Submission Date -->
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.submission_date.id_for_label }}" class="form-label fw-semibold">
                                    <i class="fa-solid fa-calendar-alt text-info me-1"></i>
                                    Submission Date
                                </label>
                                <input type="date" 
                                       class="form-control {% if form.submission_date.errors %}is-invalid{% endif %}" 
                                       id="{{ form.submission_date.id_for_label }}" 
                                       name="{{ form.submission_date.name }}" 
                                       value="{{ form.submission_date.value|date:'Y-m-d'|default:'' }}">
                                {% if form.submission_date.errors %}
                                    <div class="invalid-feedback">
                                        {{ form.submission_date.errors|first }}
                                    </div>
                                {% endif %}
                                {% if form.submission_date.help_text %}
                                    <div class="form-text">{{ form.submission_date.help_text }}</div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- Description Section -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h6 class="fw-bold text-info border-bottom pb-2 mb-3">
                                    <i class="fa-solid fa-file-alt me-2"></i>Description & Documentation
                                </h6>
                            </div>

                            <!-- Description -->
                            <div class="col-12 mb-3">
                                <label for="{{ form.description.id_for_label }}" class="form-label fw-semibold">
                                    <i class="fa-solid fa-align-left text-info me-1"></i>
                                    Detailed Description
                                </label>
                                <textarea class="form-control {% if form.description.errors %}is-invalid{% endif %}" 
                                          id="{{ form.description.id_for_label }}" 
                                          name="{{ form.description.name }}" 
                                          rows="5"
                                          placeholder="Provide a comprehensive description of the outcome, its significance, and impact...">{{ form.description.value|default:'' }}</textarea>
                                {% if form.description.errors %}
                                    <div class="invalid-feedback">
                                        {{ form.description.errors|first }}
                                    </div>
                                {% endif %}
                                {% if form.description.help_text %}
                                    <div class="form-text">{{ form.description.help_text }}</div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- Commercialization Section -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h6 class="fw-bold text-warning border-bottom pb-2 mb-3">
                                    <i class="fa-solid fa-chart-line me-2"></i>Commercialization Status
                                </h6>
                            </div>

                            <!-- Commercialization Status -->
                            <div class="col-md-6 mb-3">
                                <label for="{{ form.commercialization_status.id_for_label }}" class="form-label fw-semibold">
                                    <i class="fa-solid fa-business-time text-warning me-1"></i>
                                    Commercialization Status
                                </label>
                                <select class="form-select {% if form.commercialization_status.errors %}is-invalid{% endif %}" 
                                        id="{{ form.commercialization_status.id_for_label }}" 
                                        name="{{ form.commercialization_status.name }}">
                                    <option value="">Select Status</option>
                                    {% for value, label in form.commercialization_status.field.choices %}
                                        {% if value %}
                                            <option value="{{ value }}" 
                                                    {% if value == form.commercialization_status.value %}selected{% endif %}>
                                                {{ label }}
                                            </option>
                                        {% endif %}
                                    {% endfor %}
                                </select>
                                {% if form.commercialization_status.errors %}
                                    <div class="invalid-feedback">
                                        {{ form.commercialization_status.errors|first }}
                                    </div>
                                {% endif %}
                                {% if form.commercialization_status.help_text %}
                                    <div class="form-text">{{ form.commercialization_status.help_text }}</div>
                                {% endif %}
                            </div>

                            <!-- Commercialized -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-semibold">
                                    <i class="fa-solid fa-store text-success me-1"></i>
                                    Commercialization Status
                                </label>
                                <div class="form-check form-switch mt-2">
                                    <input class="form-check-input {% if form.commercialized.errors %}is-invalid{% endif %}" 
                                           type="checkbox" 
                                           id="{{ form.commercialized.id_for_label }}" 
                                           name="{{ form.commercialized.name }}"
                                           {% if form.commercialized.value %}checked{% endif %}>
                                    <label class="form-check-label" for="{{ form.commercialized.id_for_label }}">
                                        <span class="fw-semibold">Successfully Commercialized</span>
                                        <br><small class="text-muted">Outcome has been brought to market</small>
                                    </label>
                                    {% if form.commercialized.errors %}
                                        <div class="invalid-feedback d-block">
                                            {{ form.commercialized.errors|first }}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                        <!-- Additional Information Section -->
                        <div class="row mb-4">
                            <div class="col-12">
                                <h6 class="fw-bold text-secondary border-bottom pb-2 mb-3">
                                    <i class="fa-solid fa-info-circle me-2"></i>Additional Information
                                </h6>
                            </div>

                            <!-- Additional Notes -->
                            <div class="col-12 mb-3">
                                <label for="{{ form.additional_notes.id_for_label }}" class="form-label fw-semibold">
                                    <i class="fa-solid fa-sticky-note text-secondary me-1"></i>
                                    Additional Notes
                                </label>
                                <textarea class="form-control {% if form.additional_notes.errors %}is-invalid{% endif %}" 
                                          id="{{ form.additional_notes.id_for_label }}" 
                                          name="{{ form.additional_notes.name }}" 
                                          rows="3"
                                          placeholder="Any additional comments, future plans, or relevant information...">{{ form.additional_notes.value|default:'' }}</textarea>
                                {% if form.additional_notes.errors %}
                                    <div class="invalid-feedback">
                                        {{ form.additional_notes.errors|first }}
                                    </div>
                                {% endif %}
                                {% if form.additional_notes.help_text %}
                                    <div class="form-text">{{ form.additional_notes.help_text }}</div>
                                {% endif %}
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="d-flex justify-content-end gap-3 pt-3 border-top">
                            <a href="{% url 'core:outcome_list' %}" class="btn btn-outline-secondary">
                                <i class="fa-solid fa-times me-2"></i>Cancel
                            </a>
                            <button type="submit" class="btn btn-warning">
                                <i class="fa-solid fa-save me-2"></i>
                                {% if object %}Update Outcome{% else %}Record Outcome{% endif %}
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Help Section -->
            <div class="mt-4">
                <div class="card border-0 bg-light">
                    <div class="card-body p-3">
                        <h6 class="fw-semibold mb-2">
                            <i class="fa-solid fa-lightbulb text-warning me-2"></i>Outcome Documentation Guidelines
                        </h6>
                        <ul class="small text-muted mb-0 ps-3">
                            <li><strong>Outcome Types:</strong> Include prototypes, publications, patents, products, or services</li>
                            <li><strong>Description:</strong> Clearly describe the achievement, its innovation, and potential impact</li>
                            <li><strong>Commercialization:</strong> Track the journey from research to market implementation</li>
                            <li><strong>Documentation:</strong> Include submission dates for patents, publications, or product launches</li>
                            <li><strong>Impact Assessment:</strong> Note any social, economic, or technological impact achieved</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}